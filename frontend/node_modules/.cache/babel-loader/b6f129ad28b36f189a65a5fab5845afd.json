{"ast":null,"code":"/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils'; // Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\n\nexport function filterIceServers(iceServers, edgeVersion) {\n  let hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(server => {\n    if (server && (server.urls || server.url)) {\n      let urls = server.urls || server.url;\n\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n\n      const isString = typeof urls === 'string';\n\n      if (isString) {\n        urls = [urls];\n      }\n\n      urls = urls.filter(url => {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        const validTurn = url.startsWith('turn') && !url.startsWith('turn:[') && url.includes('transport=udp');\n\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n\n        return validTurn && !hasTurn;\n      });\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}","map":{"version":3,"names":["utils","filterIceServers","iceServers","edgeVersion","hasTurn","JSON","parse","stringify","filter","server","urls","url","deprecated","isString","indexOf","validTurn","startsWith","includes","length"],"sources":["/Users/diaskywashi/Desktop/pettochat/frontend/node_modules/webrtc-adapter/src/js/edge/filtericeservers.js"],"sourcesContent":["/*\n *  Copyright (c) 2018 The WebRTC project authors. All Rights Reserved.\n *\n *  Use of this source code is governed by a BSD-style license\n *  that can be found in the LICENSE file in the root of the source\n *  tree.\n */\n/* eslint-env node */\n'use strict';\n\nimport * as utils from '../utils';\n// Edge does not like\n// 1) stun: filtered after 14393 unless ?transport=udp is present\n// 2) turn: that does not have all of turn:host:port?transport=udp\n// 3) turn: with ipv6 addresses\n// 4) turn: occurring muliple times\nexport function filterIceServers(iceServers, edgeVersion) {\n  let hasTurn = false;\n  iceServers = JSON.parse(JSON.stringify(iceServers));\n  return iceServers.filter(server => {\n    if (server && (server.urls || server.url)) {\n      let urls = server.urls || server.url;\n      if (server.url && !server.urls) {\n        utils.deprecated('RTCIceServer.url', 'RTCIceServer.urls');\n      }\n      const isString = typeof urls === 'string';\n      if (isString) {\n        urls = [urls];\n      }\n      urls = urls.filter(url => {\n        // filter STUN unconditionally.\n        if (url.indexOf('stun:') === 0) {\n          return false;\n        }\n\n        const validTurn = url.startsWith('turn') &&\n            !url.startsWith('turn:[') &&\n            url.includes('transport=udp');\n        if (validTurn && !hasTurn) {\n          hasTurn = true;\n          return true;\n        }\n        return validTurn && !hasTurn;\n      });\n\n      delete server.url;\n      server.urls = isString ? urls[0] : urls;\n      return !!urls.length;\n    }\n  });\n}\n"],"mappings":"AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;AACA;;AAEA,OAAO,KAAKA,KAAZ,MAAuB,UAAvB,C,CACA;AACA;AACA;AACA;AACA;;AACA,OAAO,SAASC,gBAAT,CAA0BC,UAA1B,EAAsCC,WAAtC,EAAmD;EACxD,IAAIC,OAAO,GAAG,KAAd;EACAF,UAAU,GAAGG,IAAI,CAACC,KAAL,CAAWD,IAAI,CAACE,SAAL,CAAeL,UAAf,CAAX,CAAb;EACA,OAAOA,UAAU,CAACM,MAAX,CAAkBC,MAAM,IAAI;IACjC,IAAIA,MAAM,KAAKA,MAAM,CAACC,IAAP,IAAeD,MAAM,CAACE,GAA3B,CAAV,EAA2C;MACzC,IAAID,IAAI,GAAGD,MAAM,CAACC,IAAP,IAAeD,MAAM,CAACE,GAAjC;;MACA,IAAIF,MAAM,CAACE,GAAP,IAAc,CAACF,MAAM,CAACC,IAA1B,EAAgC;QAC9BV,KAAK,CAACY,UAAN,CAAiB,kBAAjB,EAAqC,mBAArC;MACD;;MACD,MAAMC,QAAQ,GAAG,OAAOH,IAAP,KAAgB,QAAjC;;MACA,IAAIG,QAAJ,EAAc;QACZH,IAAI,GAAG,CAACA,IAAD,CAAP;MACD;;MACDA,IAAI,GAAGA,IAAI,CAACF,MAAL,CAAYG,GAAG,IAAI;QACxB;QACA,IAAIA,GAAG,CAACG,OAAJ,CAAY,OAAZ,MAAyB,CAA7B,EAAgC;UAC9B,OAAO,KAAP;QACD;;QAED,MAAMC,SAAS,GAAGJ,GAAG,CAACK,UAAJ,CAAe,MAAf,KACd,CAACL,GAAG,CAACK,UAAJ,CAAe,QAAf,CADa,IAEdL,GAAG,CAACM,QAAJ,CAAa,eAAb,CAFJ;;QAGA,IAAIF,SAAS,IAAI,CAACX,OAAlB,EAA2B;UACzBA,OAAO,GAAG,IAAV;UACA,OAAO,IAAP;QACD;;QACD,OAAOW,SAAS,IAAI,CAACX,OAArB;MACD,CAdM,CAAP;MAgBA,OAAOK,MAAM,CAACE,GAAd;MACAF,MAAM,CAACC,IAAP,GAAcG,QAAQ,GAAGH,IAAI,CAAC,CAAD,CAAP,GAAaA,IAAnC;MACA,OAAO,CAAC,CAACA,IAAI,CAACQ,MAAd;IACD;EACF,CA9BM,CAAP;AA+BD"},"metadata":{},"sourceType":"module"}